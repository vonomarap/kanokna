<Technology version="1.0">
  <Services>
    <Service name="catalog-configuration-service">
      <Runtime>
        <Language>Java 25</Language>
        <Framework>
          <SpringBoot version="4.0.x"/>
          <SpringFramework version="7.x"/>
        </Framework>
      </Runtime>

      <APIs>
        <REST enabled="true">
          <BasePath>/api/v1/catalog</BasePath>
          <OpenAPI>catalog-configuration-service-openapi.yaml</OpenAPI>
        </REST>
        <GraphQL enabled="true">
          <Endpoint>/graphql/catalog</Endpoint>
        </GraphQL>
      </APIs>

      <Persistence>
        <Database type="PostgreSQL" version="15">
          <Usage>Primary OLTP store for templates, attributes, rules, versions.</Usage>
        </Database>
        <MigrationTool>Flyway</MigrationTool>
        <ORM>Hibernate 6.x via Spring Data JPA</ORM>
      </Persistence>

      <Caching>
        <Redis enabled="true">
          <Usage>
            Cache of ACTIVE catalog versions and option sets for query use-cases.
          </Usage>
        </Redis>
      </Caching>

      <Search>
        <Elasticsearch enabled="true">
          <Usage>
            External search index for product templates and marketing attributes.
            Indexed asynchronously on publish events.
          </Usage>
        </Elasticsearch>
      </Search>

      <Messaging>
        <Kafka>
          <OutboundTopics>
            <Topic name="catalog.product-template-changed" key="productTemplateId"/>
            <Topic name="catalog.version-published" key="catalogVersionId"/>
          </OutboundTopics>
          <InboundTopics>
            <!-- optional: e.g. react to external reference data changes -->
          </InboundTopics>
        </Kafka>
      </Messaging>

      <Integrations>
        <ServiceRef name="media-service" purpose="validate and link product images"/>
        <ServiceRef name="pricing-service" purpose="share configuration attributes and rules relevant for pricing"/>
        <ServiceRef name="notification-service" purpose="notify admins on validation failures and publish events"/>
      </Integrations>

      <Observability>
        <Micrometer enabled="true"/>
        <OpenTelemetry traces="true" logs="true"/>
        <Dashboards>
          <Dashboard name="catalog-configuration-latency"/>
          <Dashboard name="catalog-configuration-errors"/>
        </Dashboards>
      </Observability>
    </Service>
  </Services>
</Technology>
