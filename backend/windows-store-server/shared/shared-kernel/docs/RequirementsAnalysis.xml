<RequirementsAnalysis version="1.0">
  <Domain id="shared-kernel">
    <Description>
      Stable, framework-free domain primitives (value objects, enums, domain events, identifiers)
      reused across bounded contexts without introducing coupling to Spring, JPA, or transport layers.
    </Description>
  </Domain>

  <Actors>
    <Actor id="SERVICE">
      <Name>DomainServiceConsumer</Name>
      <Goals>
        <Goal id="G-REUSE-PRIMITIVES">Reuse consistent primitives (Money, Dimensions, LocalizedString, Id)</Goal>
        <Goal id="G-DOMAIN-EVENT">Publish/handle domain events with a shared contract</Goal>
        <Goal id="G-I18N">Represent localized strings safely</Goal>
      </Goals>
    </Actor>
    <Actor id="DEV">
      <Name>Developer</Name>
      <Goals>
        <Goal id="G-CONSISTENCY">Keep cross-service types small, stable, and framework-free</Goal>
        <Goal id="G-VALIDATION">Enforce invariants early (email, money, dimensions)</Goal>
      </Goals>
    </Actor>
  </Actors>

  <UseCases>
    <UseCase id="UC-ID-GENERATION">
      <ActorRef ref="SERVICE"/>
      <Action>Creates opaque identifiers</Action>
      <Goal>Generate and validate Id values for aggregates</Goal>
      <Preconditions>None</Preconditions>
      <Postconditions>Returns validated Id; rejects invalid UUIDs</Postconditions>
      <MainFlow>Call Id.random() or Id.of(value) -> validated -> value object returned</MainFlow>
      <AlternateFlows>Invalid UUID string -> DomainException</AlternateFlows>
      <Links>
        <Link ref="DevelopmentPlan.xml#Contracts"/>
      </Links>
    </UseCase>

    <UseCase id="UC-MONEY">
      <ActorRef ref="SERVICE"/>
      <Action>Represents monetary values with currency and arithmetic</Action>
      <Goal>Perform safe arithmetic with rounding policies</Goal>
      <Preconditions>Currency provided; amount not null</Preconditions>
      <Postconditions>Money value normalized; arithmetic respects rounding policy</Postconditions>
      <MainFlow>Create Money.of(amount, currency) -> optional rounding -> result</MainFlow>
      <AlternateFlows>Null inputs -> DomainException; currency mismatch on add/subtract -> error</AlternateFlows>
      <Links>
        <Link ref="Technology.xml#Runtime"/>
      </Links>
    </UseCase>

    <UseCase id="UC-DIMENSIONS">
      <ActorRef ref="SERVICE"/>
      <Action>Validates dimensions for window/door products</Action>
      <Goal>Ensure dimensions fall within accepted ranges</Goal>
      <Preconditions>Width/height provided</Preconditions>
      <Postconditions>DimensionsCm created or error raised</Postconditions>
      <MainFlow>Create DimensionsCm.of(width,height) -> validates min/max/range -> returns value</MainFlow>
      <AlternateFlows>Values outside range -> DomainException</AlternateFlows>
    </UseCase>

    <UseCase id="UC-DOMAIN-EVENT">
      <ActorRef ref="SERVICE"/>
      <Action>Defines domain event contract</Action>
      <Goal>Provide consistent metadata (id, occurredOn, tenant, correlation)</Goal>
      <Preconditions>None</Preconditions>
      <Postconditions>DomainEvent implemented by services with required metadata</Postconditions>
      <MainFlow>Service implements DomainEvent -> attaches ids/timestamps -> published via adapters</MainFlow>
    </UseCase>
  </UseCases>

  <NonFunctionalRequirements>
    <Requirement id="NFR-STABILITY">Shared types change rarely; versioned carefully</Requirement>
    <Requirement id="NFR-FRAMEWORK-FREE">No dependencies on Spring, JPA, or transport libraries</Requirement>
    <Requirement id="NFR-TESTABILITY">All primitives fully unit-tested in isolation</Requirement>
  </NonFunctionalRequirements>

  <Links>
    <Link ref="Technology.xml"/>
    <Link ref="DevelopmentPlan.xml"/>
  </Links>
</RequirementsAnalysis>
