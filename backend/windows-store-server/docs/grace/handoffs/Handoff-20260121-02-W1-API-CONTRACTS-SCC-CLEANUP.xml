<?xml version="1.0" encoding="UTF-8"?>
<!--
  GRACE Handoff: API Contracts Spring Cloud Contract Cleanup
  AWO Reference: AWO-20260121-02-API-CONTRACTS-RESTASSURED.xml
  Created: 2026-01-21T17:00:00+03:00
  CreatedBy: GRACE-CODER (executing AWO-20260121-02)
  Status: COMPLETE
  SchemaVersion: grace-markup-v2
-->

<!-- ═══════════════════════════════════════════════════════════════════════════
     GIT_IMPACT (MANDATORY per Section 19A.4)
     Advisory block for Coordinator - implementation complete
     ═══════════════════════════════════════════════════════════════════════════ -->
<GIT_IMPACT id="GIT-20260121-02" status="ADVISORY">
  <ChangeClassification>bugfix</ChangeClassification>
  <Rationale>
    Build failure remediation. Spring Cloud Contract verifier was incorrectly
    configured in api-contracts (library module), causing MockMVC test failures.
    Removal of SCC infrastructure restores build stability per architectural
    decision DEC-API-CONTRACTS-SCC-ROLE (Option A: Producer-Side Verification).
  </Rationale>
  <AffectedServices>
    <ServiceRef ref="DP-SVC-api-contracts" note="Remove SCC verifier infrastructure" />
  </AffectedServices>
  <InfrastructureChanges>
    <File path="api-contracts/pom.xml" action="UPDATE">
      Remove SCC plugin, SCC dependencies, rest-assured dependency, version property
    </File>
    <Directory path="api-contracts/src/test/resources/contracts/" action="DELETE">
      Remove empty contracts directory (files already deleted)
    </Directory>
  </InfrastructureChanges>
  <DefaultRouting>
    <BaseBranch>develop</BaseBranch>
    <PRTarget>develop</PRTarget>
    <RequiresBackMergeToDevelop>false</RequiresBackMergeToDevelop>
    <PreferredMergeMethod>squash</PreferredMergeMethod>
  </DefaultRouting>
  <BranchNaming>
    <Pattern>bugfix/W1-api-contracts-scc-cleanup</Pattern>
    <TicketPolicy status="ASSUMED">No external ticket; use AWO-20260121-02 as reference</TicketPolicy>
  </BranchNaming>
  <RiskNotes>
    <Item>LOW RISK: Removes unused infrastructure, no runtime behavior change</Item>
    <Item>Contracts not currently verified anywhere (were never executing successfully)</Item>
    <Item>Future work: Move contracts to producer services when ready (PHASE-02 deferred)</Item>
  </RiskNotes>
</GIT_IMPACT>

<GRACE_HANDOFF
    id="Handoff-20260121-02-W1-API-CONTRACTS-SCC-CLEANUP"
    status="COMPLETE"
    schemaVersion="grace-markup-v2"
    created="2026-01-21T17:00:00+03:00"
    author="GRACE-CODER"
    taskRef="W1-INFRA-API-CONTRACTS-ARCHITECTURE-FIX"
    awoRef="AWO-20260121-02-API-CONTRACTS-RESTASSURED"
>
  <Summary>
    Remove Spring Cloud Contract verifier infrastructure from api-contracts module.
    This fixes the build failure caused by verifier tests requiring MockMVC context
    in a library module that cannot provide controllers by design.
  </Summary>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       DECISIONS APPLIED
       ═══════════════════════════════════════════════════════════════════════════ -->
  <DecisionsSummary>
    <Decision id="DEC-API-CONTRACTS-SCC-ROLE" status="APPLIED">
      Producer-Side Verification (Option A): Contract verification belongs in
      producer services, not in the contract definition library module.
    </Decision>
  </DecisionsSummary>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       CHANGES MADE (PHASE-01 COMPLETE)
       ═══════════════════════════════════════════════════════════════════════════ -->
  <ChangesMade>
    <Task id="T01-01" status="COMPLETE">
      <Action>Removed spring-cloud-contract-maven-plugin from pom.xml</Action>
      <File>backend/windows-store-server/api-contracts/pom.xml</File>
    </Task>
    <Task id="T01-02" status="COMPLETE">
      <Action>Removed spring-cloud-contract-spec dependency (test scope)</Action>
      <File>backend/windows-store-server/api-contracts/pom.xml</File>
    </Task>
    <Task id="T01-03" status="COMPLETE">
      <Action>Removed spring-cloud-contract-verifier dependency (test scope)</Action>
      <File>backend/windows-store-server/api-contracts/pom.xml</File>
    </Task>
    <Task id="T01-04" status="COMPLETE">
      <Action>Removed io.rest-assured:spring-mock-mvc dependency (test scope)</Action>
      <File>backend/windows-store-server/api-contracts/pom.xml</File>
    </Task>
    <Task id="T01-05" status="COMPLETE">
      <Action>Removed rest-assured.version property</Action>
      <File>backend/windows-store-server/api-contracts/pom.xml</File>
    </Task>
    <Task id="T01-06" status="COMPLETE">
      <Action>Deleted contracts directory</Action>
      <Directory>backend/windows-store-server/api-contracts/src/test/resources/contracts/</Directory>
      <Note>Directory contained empty subdirs (cart-service/, catalog-service/, pricing-service/);
            original contract files already deleted per git status</Note>
    </Task>
  </ChangesMade>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       VERIFICATION RESULTS
       ═══════════════════════════════════════════════════════════════════════════ -->
  <Verification>
    <Check id="V-01" status="PASS">
      <Command>mvn clean verify -pl api-contracts</Command>
      <Result>BUILD SUCCESS (only Java 25 native access warnings)</Result>
    </Check>
    <Check id="V-02" status="PENDING">
      <Command>Full project mvn clean verify</Command>
      <Note>Requires Coordinator to run after commit/merge</Note>
    </Check>
  </Verification>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       ACCEPTANCE CRITERIA STATUS
       ═══════════════════════════════════════════════════════════════════════════ -->
  <AcceptanceCriteria>
    <Item id="AC-01" status="PASS">api-contracts/pom.xml has NO spring-cloud-contract-maven-plugin</Item>
    <Item id="AC-02" status="PASS">api-contracts/pom.xml has NO spring-cloud-contract-* dependencies</Item>
    <Item id="AC-03" status="PASS">api-contracts/pom.xml has NO rest-assured dependencies</Item>
    <Item id="AC-04" status="PASS">No contracts directory in api-contracts/src/test/resources/</Item>
    <Item id="AC-05" status="PASS">mvn clean verify -pl api-contracts succeeds</Item>
    <Item id="AC-06" status="PENDING">Full build mvn clean verify succeeds (Coordinator verification)</Item>
    <Item id="AC-07" status="PASS">No domain logic changes</Item>
  </AcceptanceCriteria>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       DEFERRED WORK (PHASE-02)
       ═══════════════════════════════════════════════════════════════════════════ -->
  <DeferredWork>
    <Phase id="PHASE-02" name="pricing-service Contract Setup" status="DEFERRED">
      <Reason>
        Contracts require actual REST endpoints to verify against. Setting up
        contract verification in pricing-service should be done when the pricing
        REST API is implemented and ready for contract testing.
      </Reason>
      <Tasks>
        <Task id="T02-01">Create contracts directory in pricing-service</Task>
        <Task id="T02-02">Move calculate_quote.groovy to pricing-service</Task>
        <Task id="T02-03">Add spring-cloud-contract-maven-plugin to pricing-service</Task>
        <Task id="T02-04">Create ContractVerifierBase test class</Task>
        <Task id="T02-05">Verify contract tests pass</Task>
      </Tasks>
    </Phase>
  </DeferredWork>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       COMMIT TEMPLATE
       ═══════════════════════════════════════════════════════════════════════════ -->
  <CommitTemplate>
    <![CDATA[
[W1-INFRA] Remove Spring Cloud Contract verifier from api-contracts

- Remove spring-cloud-contract-maven-plugin (incorrect location)
- Remove spring-cloud-contract-* dependencies (test scope)
- Remove rest-assured dependency (test scope)
- Delete contracts directory (to be moved to producer services later)

This fixes the build failure caused by verifier tests requiring
MockMVC context in a library module. Contract verification will
be implemented in producer services in a future wave.

Resolves: CODE-ISS-RPT-20260121-01
AWO: AWO-20260121-02-API-CONTRACTS-RESTASSURED
Handoff: Handoff-20260121-02-W1-API-CONTRACTS-SCC-CLEANUP

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
    ]]>
  </CommitTemplate>

  <!-- ═══════════════════════════════════════════════════════════════════════════
       LINKS
       ═══════════════════════════════════════════════════════════════════════════ -->
  <Links>
    <Link ref="AWO-20260121-02-API-CONTRACTS-RESTASSURED.xml"/>
    <Link ref="CodeIssueReport-20260121-01-API-CONTRACTS-RESTASSURED.xml"/>
    <Link ref="Technology.xml#TECH-spring-cloud"/>
    <Link ref="DevelopmentPlan.xml#DP-SVC-api-contracts"/>
  </Links>
</GRACE_HANDOFF>
